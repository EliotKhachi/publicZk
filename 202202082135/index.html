<h1 id="how-to-connect-usb-devices-to-wsl">How to Connect USB Devices to WSL</h1>
<h2 id="setup">Setup</h2>
<ol type="1">
<li>Make sure you have a WSL kernel version of 5.10.60.1 or later, and you are running a WSL 2 distro.<br />
</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="fu">uname</span> - a</span></code></pre></div>
<ol start="2" type="1">
<li>Install the user space tools for USB/IP and a database of USB hardware indentifiers: From within WSL on Ubunto 20.04 LTS, run<br />
</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="fu">sudo</span> apt install linux-tools-5.4.0-77-generic hwdata  </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="fu">sudo</span> update-alternatives --install /usr/local/bin/usbip usbip /usr/lib/linux-tools/5.4.0-77-generic/usbip 20  </span></code></pre></div>
<h2 id="attaching-a-device">Attaching a device</h2>
<ol start="3" type="1">
<li>Connect STLINK device to usb hub on computer<br />
</li>
<li>List all USB devices connected to Windows <em>as administrator</em><br />
</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="ex">gsudo</span> usbipd wsl list  </span></code></pre></div>
<ol start="5" type="1">
<li>Identify the bus ID of the device youâ€™d like to attach to WSL and run<br />
</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="ex">usbipd</span> wsl attach --busid <span class="op">&lt;</span>busid<span class="op">&gt;</span>  </span></code></pre></div>
<ol start="6" type="1">
<li>From within WSL, list the attached USB devices to verify that WSL recognizes them<br />
</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="ex">lsusb</span>  </span></code></pre></div>
<ol start="7" type="1">
<li>Once your done using the device in WSL, you can physically disconnect the device or detach the device <em>as administrator</em><br />
</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="ex">gsudo</span> usbipd wsl detach --busid <span class="op">&lt;</span>busid<span class="op">&gt;</span>  </span></code></pre></div>
<p>For more information on how this works, see Reference [1].</p>
<h2 id="references">References</h2>
<ol type="1">
<li><a href="https://devblogs.microsoft.com/commandline/connecting-usb-devices-to-wsl/">Connecting USB devices to WSL - Microsoft Docs</a></li>
</ol>
<h2 id="tags">Tags</h2>
<p>#wsl</p>
